<div class="row row-full">
  <div class="col-md-4">
    <div class="well well-full">
      <p class="text-center">
        <a href="#/document/add" class="btn btn-primary"><span class="glyphicon glyphicon-plus"></span> {{ 'document.add_document' | translate }}</a>
      </p>

      <div class="row">
        <div class="dropdown col-md-2 tag-tree-dropdown" dropdown>
          <button class="btn btn-block btn-default" dropdown-toggle ng-disabled="disabled">
            {{ 'document.tags' | translate }} <span class="caret"></span>
          </button>
          <ul class="dropdown-menu tag-tree">
            <li ng-if="getChildrenTags().length == 0">{{ 'document.no_tags' | translate }}</li>
            <li ng-repeat="tag in getChildrenTags()" ng-include="'tag-tree-item'"></li>
          </ul>
        </div>

        <div class="col-md-10 input-group">
          <span class="input-group-addon">
            <span class="glyphicon glyphicon glyphicon-info-sign"
                  tooltip-placement="bottom"
                  tooltip-html-unsafe="before:2012-05<br/>
              after:2012-05<br/>
              at:2012-05<br/>
              tag:car<br/>
              full:led<br/>
              shared:yes<br/>
              lang:fra<br/>
              by:user1"></span>
          </span>
          <input type="search" class="form-control" placeholder="{{ 'document.search' | translate }}" ng-model="search" />
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-search" ng-show="search.length == 0"></span>
            <span class="glyphicon glyphicon-remove" ng-show="search.length > 0" ng-click="search = ''"></span>
          </span>
        </div>
      </div>

      <table class="row table table-hover table-documents">
        <thead>
        <tr>
          <th class="col-xs-6" ng-click="sortDocuments(1)"><span class="glyphicon glyphicon-chevron-{{ sortColumn == 1 ? (asc ? 'down' : 'up') : '' }}"></span> {{ 'document.title' | translate }}</th>
          <th class="col-xs-3" ng-click="sortDocuments(3)"><span class="glyphicon glyphicon-chevron-{{ sortColumn == 3 ? (asc ? 'down' : 'up') : '' }}"></span> {{ 'document.creation_date' | translate }}</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-if="!documents">
          <td colspan="2" class="text-center">
            <img src="img/loader.gif" />
          </td>
        </tr>

        <tr ng-if="totalDocuments == 0">
          <td colspan="2" class="text-center">
            <span ng-if="search.length == 0">{{ 'document.no_documents' | translate }}</span>
            <span ng-if="search.length > 0" translate="document.search_empty" translate-values="{ search: search }"></span>
          </td>
        </tr>

        <tr ng-click="viewDocument(document.id)" ng-repeat="document in documents" ng-class="{ active: $stateParams.id == document.id }">
          <td colspan="2">
            {{ document.title }} ({{ document.file_count }})
            <span class="glyphicon glyphicon-share" ng-if="document.shared" tooltip="{{ 'document.shared' | translate }}"></span>
            <a href="#/document/view/{{ document.id }}" target="_blank" ng-click="$event.stopPropagation()"><span class="glyphicon glyphicon-link"></span></a>

            <div class="pull-right text-muted small">{{ document.create_date | timeAgo: 'yyyy-MM-dd' }}</div>

            <div class="tags small">
              <span class="label label-info" ng-repeat="tag in document.tags" ng-style="{ 'background': tag.color }">
                {{ tag.name }}
              </span>
            </div>
          </td>
        </tr>
        </tbody>
      </table>

      <div class="text-center pagination-box">
        <pagination total-items="totalDocuments" items-per-page="limit" max-size="5" page="currentPage"></pagination>
        <label class="sr-only" for="pagesizeSelect">{{ 'document.page_size' | translate }}</label>
        <select ng-model="limit" id="pagesizeSelect" class="form-control">
          <option value="10">{{ 'document.page_size_10' | translate }}</option>
          <option value="20">{{ 'document.page_size_20' | translate }}</option>
          <option value="30">{{ 'document.page_size_30' | translate }}</option>
        </select>
      </div>

      <div class="pull-left" title="{{ 'document.upgrade_quota' | translate }}">
        {{ 'document.quota' | translate: '{ current: userInfo.storage_current / 1000000, percent: userInfo.storage_current / userInfo.storage_quota * 100, total: userInfo.storage_quota / 1000000 }' }}
      </div>

      <div class="text-right" >
        <span ng-if="totalDocuments">
          {{ 'document.count' | translate: '{ count: totalDocuments }' }}
        </span>
        <span ng-if="!totalDocuments">&nbsp;</span>
      </div>
    </div>
  </div>

  <div class="col-md-8 col-full">
    <div ui-view="document"></div>
  </div>
</div>

<script type="text/ng-template" id="tag-tree-item">
  <span class="btn" ng-style="{ 'background-color': tag.color }"></span>
  <span class="btn btn-link" ng-click="setSearch('tag:' + tag.name)">
    {{ tag.name }}
  </span>
  <ul class="list-unstyled">
    <li ng-repeat="tag in getChildrenTags(tag.id)" ng-include="'tag-tree-item'"></li>
  </ul>
</script>