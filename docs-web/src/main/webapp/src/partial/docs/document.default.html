<img src="img/loader.gif" ng-show="!app" />

<div ng-show="app">
  <div class="well">
    <h3><span class="glyphicon glyphicon-cloud-upload"></span> {{ 'document.default.quick_upload' | translate }}</h3>
    <div class="row upload-zone" ng-model="dropFiles" ng-file-drop drag-over-class="bg-success"
         ng-multiple="true" allow-dir="false" ng-file-change="fileDropped($files, $event, $rejectedFiles)">
      <div class="col-xs-6 col-sm-4 col-md-3 col-lg-2 text-center" ng-repeat="file in files">
        <div class="thumbnail" ng-class="{ 'thumbnail-checked': file.checked }" ng-if="file.id">
          <a ng-click="openFile(file)">
            <img class="thumbnail-file" ng-src="../api/file/{{ file.id }}/data?size=thumb" tooltip="{{ file.mimetype }} | {{ file.size | filesize }}" tooltip-placement="top" />
          </a>
          <div class="caption">
            <div class="pull-left">
              <input type="checkbox" ng-model="file.checked" />
            </div>
            <div class="pull-right">
              <button class="btn btn-danger" ng-click="deleteFile($event, file)"><span class="glyphicon glyphicon-trash"></span></button>
            </div>
            <div class="clearfix"></div>
          </div>
        </div>

        <div class="thumbnail" ng-if="!file.id">
          <p class="text-center lead">
            {{ file.status }}
          </p>
          <div class="caption">
            <progressbar value="file.progress" class="progress-info active"></progressbar>
          </div>
        </div>
      </div>

      <p class="text-center well-lg" ng-if="files.length == 0">
        <span class="glyphicon glyphicon-move"></span>
        {{ 'document.default.drop_zone' | translate }}
      </p>
    </div>

    <div class="btn-group" ng-show="checkedFiles().length > 0">
      <button class="btn btn-primary" ng-click="addDocument()"><span class="glyphicon glyphicon-plus"></span> {{ 'document.default.add_new_document' | translate }}</button>
    </div>
  </div>

  <div ui-view="file"></div>

  <div>
    <h3><span class="glyphicon glyphicon-tasks"></span> {{ 'document.default.latest_activity' | translate }}</h3>
    <audit-log logs="logs" />
  </div>

  <div class="text-muted text-right">
    <ul class="list-inline">
      <li translate="document.default.footer_sismics"></li>
      <li><a href="apidoc/">{{ 'document.default.api_documentation' | translate }}</a></li>
      <li><strong>{{ 'document.default.version' | translate }}</strong> {{ app.current_version }}</li>
      <li><strong>{{ 'document.default.memory' | translate }}</strong> {{ app.free_memory / 1000000 | number: 0 }}/{{ app.total_memory / 1000000 | number: 0 }} MB</li>
    </ul>
  </div>
</div>